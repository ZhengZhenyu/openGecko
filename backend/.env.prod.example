# =====================================================================
# openGecko 生产环境配置模板
# 复制为 backend/.env 并填写所有必填项后再部署
# =====================================================================

# ─────────────────────────────────────────────────────────────────────
# 数据库 [必填]
# ─────────────────────────────────────────────────────────────────────
# 生产环境强烈建议使用 PostgreSQL
DATABASE_URL=postgresql://opengecko:YOUR_DB_PASSWORD@db:5432/opengecko
# 连接池配置（PostgreSQL）
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=1800
DB_ECHO=false

# ─────────────────────────────────────────────────────────────────────
# 安全 [必填]
# ─────────────────────────────────────────────────────────────────────
# JWT 密钥：使用 `openssl rand -hex 32` 生成强随机密钥
JWT_SECRET_KEY=REPLACE_WITH_STRONG_RANDOM_KEY_32_BYTES_HEX
# Token 有效期（分钟）
ACCESS_TOKEN_EXPIRE_MINUTES=60

# ─────────────────────────────────────────────────────────────────────
# CORS [必填]
# ─────────────────────────────────────────────────────────────────────
# 多个域名用英文逗号分隔，禁止在生产环境使用 *
CORS_ORIGINS=https://your-domain.com,https://admin.your-domain.com

# ─────────────────────────────────────────────────────────────────────
# 速率限制
# ─────────────────────────────────────────────────────────────────────
RATE_LIMIT_LOGIN=10/minute
RATE_LIMIT_DEFAULT=120/minute

# ─────────────────────────────────────────────────────────────────────
# 初始管理员 [必填 - 首次启动后请立即修改密码]
# ─────────────────────────────────────────────────────────────────────
DEFAULT_ADMIN_USERNAME=admin
DEFAULT_ADMIN_PASSWORD=REPLACE_WITH_STRONG_INITIAL_PASSWORD
DEFAULT_ADMIN_EMAIL=admin@your-domain.com

# ─────────────────────────────────────────────────────────────────────
# 服务器配置
# ─────────────────────────────────────────────────────────────────────
HOST=0.0.0.0
PORT=8000
DEBUG=false
LOG_LEVEL=warning
LOG_FORMAT=json

# ─────────────────────────────────────────────────────────────────────
# 文件存储 [推荐使用 MinIO 对象存储]
# ─────────────────────────────────────────────────────────────────────
# 存储后端：local（本地文件系统）或 s3（MinIO / AWS S3 兼容）
STORAGE_BACKEND=s3

# S3 / MinIO 配置（仅 STORAGE_BACKEND=s3 时生效）
# Docker Compose 部署时 MinIO 容器名为 minio，内网地址为 http://minio:9000
S3_ENDPOINT_URL=http://minio:9000
S3_ACCESS_KEY=REPLACE_WITH_MINIO_ACCESS_KEY
S3_SECRET_KEY=REPLACE_WITH_MINIO_SECRET_KEY
S3_BUCKET=opengecko
# Nginx 将 /uploads/ 代理到此 URL；内网用 minio:9000，对外域名请改为公网地址
S3_PUBLIC_URL=http://minio:9000/opengecko

# 文件上传最大大小（字节），默认 50MB
MAX_UPLOAD_SIZE=52428800

# ─────────────────────────────────────────────────────────────────────
# SMTP 邮件（可选，用于密码重置通知）
# ─────────────────────────────────────────────────────────────────────
# SMTP_HOST=smtp.your-provider.com
# SMTP_PORT=587
# SMTP_USER=noreply@your-domain.com
# SMTP_PASSWORD=YOUR_SMTP_PASSWORD
# SMTP_FROM_EMAIL=noreply@your-domain.com
# SMTP_USE_TLS=true

# ─────────────────────────────────────────────────────────────────────
# 可选功能模块
# ─────────────────────────────────────────────────────────────────────
# 设为 false 则禁用「洞察与人脉」模块（人脉管理 + 生态洞察），前端自动隐藏对应菜单
# ENABLE_INSIGHTS_MODULE=true

# ─────────────────────────────────────────────────────────────────────
# 生态洞察采集服务（生产建议 COLLECTOR_EMBEDDED=false，独立容器运行）
# ─────────────────────────────────────────────────────────────────────
# GitHub Personal Access Token（生产必填，否则 60 req/h 匿名限速无法满足需求）
# GITHUB_TOKEN=ghp_xxxx
# Gitee 私人令牌（可选）
# GITEE_TOKEN=
# 全局默认采集间隔（小时），各项目可单独覆盖
# COLLECTOR_SYNC_INTERVAL_HOURS=24
# 并发采集线程数（生产可适当调高）
# COLLECTOR_MAX_WORKERS=4
# 独立采集器主循环检查间隔（秒）
# COLLECTOR_CHECK_INTERVAL_SECONDS=3600
# 生产建议设为 false，由独立容器 python run_collector.py 接管
# COLLECTOR_EMBEDDED=false
