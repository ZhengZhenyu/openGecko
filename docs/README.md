# OmniContent - 项目设计文档

<div align="center">
<img src="../logo.svg" alt="OmniContent Logo" width="100" height="100" />
</div>

本目录包含 OmniContent 企业级全域内容管理平台的完整设计文档。

**品牌定位**: 全域内容管理平台 (Manage All, Publish Everywhere)

## 📚 文档目录

### 1. 需求分析文档
- **[需求分析文档](requirements/01-需求分析文档.md)** - 完整的需求规格说明,包括功能需求、非功能需求、用户角色、验收标准等

### 2. 系统设计文档
- **[系统架构设计](design/01-系统架构设计.md)** - 系统整体架构设计,包括技术栈选型、多租户架构、API设计、安全架构、部署架构等
- **[数据库详细设计](design/02-数据库详细设计.md)** - 完整的数据库设计,包括8个表的结构定义、索引策略、迁移脚本、性能优化建议等

### 3. UML设计视图
- **[类图与时序图](uml/01-类图与时序图.md)** - 包含15个Mermaid图表:
  - 领域模型类图
  - 服务层类图
  - 5个核心业务流程时序图
  - 状态机图
  - 活动图
  - 部署图
  - 包图
  - 组件图
  - 用例图
  - 运行时对象图

### 4. 实施计划
- **[实施计划](plannings/01-实施计划.md)** - 4个阶段的详细实施计划,每个阶段<1000行代码,包括:
  - Phase 1: 基础认证与社区隔离 (~850行)
  - Phase 2: 日历视图与计划发布 (~900行)
  - Phase 3: 看板视图与流程管理 (~800行)
  - Phase 4: 可视化分析仪表板 (~950行)

## 🎯 项目概述

### 当前系统
为开源社区运营团队打造的内容管理与多渠道发布工具,已实现:
- WORD 稿件转换为各平台适配格式
- 微信公众号/官网博客/CSDN/知乎的多渠道同步发布
- 发布效果追踪与基础数据看板

### 升级目标
基于管理10+开源社区的需求,升级为企业级多租户平台:
- ✅ **多社区隔离** - 每个社区独立的数据、配置、渠道账号
- ✅ **用户认证** - JWT登录系统,支持多用户协作和操作追踪
- ✅ **日历视图** - 按时间轴规划发布计划,可拖拽安排发布日期
- ✅ **看板管理** - Kanban可视化内容流转(草稿→审核→已通过→已发布)
- ✅ **多维分析** - 按社区/渠道/作者透视,ECharts可视化仪表板
- ✅ **社区级渠道配置** - 每个社区独立的微信公众号、Hugo仓库等账号

## 🏗️ 技术架构

### 后端技术栈
- **框架**: FastAPI
- **数据库**: SQLite (开发) / PostgreSQL (生产)
- **ORM**: SQLAlchemy
- **迁移**: Alembic
- **认证**: JWT + bcrypt
- **文档转换**: python-docx, markdown

### 前端技术栈
- **框架**: Vue 3 (Composition API)
- **状态管理**: Pinia
- **UI组件**: Element Plus
- **路由**: Vue Router 4
- **日历**: FullCalendar
- **拖拽**: vue-draggable-plus
- **图表**: ECharts
- **构建工具**: Vite

### 核心特性
- **多租户架构**: 共享数据库、共享Schema、通过community_id隔离数据
- **JWT认证**: 7天有效期,自动刷新机制
- **依赖注入**: get_current_user、get_current_community实现权限控制
- **审计日志**: 完整的操作追踪记录
- **定时发布**: 基于APScheduler的自动发布系统

## 📊 数据库设计

### 核心表结构
1. **users** - 用户认证表
2. **communities** - 社区(租户)表
3. **community_users** - 用户-社区关联表(多对多)
4. **contents** - 内容主表(带community_id隔离)
5. **publish_records** - 多渠道发布记录表
6. **content_analytics** - 内容数据分析表
7. **channel_configs** - 社区级渠道配置表
8. **audit_logs** - 审计日志表

### 关键索引
- 17个索引优化查询性能
- community_id在所有隔离表上建立索引
- 复合唯一索引确保数据一致性

## 🔄 实施阶段

### Phase 1: 基础认证与社区隔离 (P0)
**目标**: 建立多租户基础架构
- 用户认证系统(JWT)
- 社区管理功能
- 数据隔离机制
- 审计日志

**验证标准**:
- ✓ 默认管理员登录成功
- ✓ 创建多个社区
- ✓ 用户只能访问授权社区的数据
- ✓ Token过期自动跳转登录

### Phase 2: 日历视图与计划发布
**目标**: 内容的时间维度管理
- FullCalendar集成
- 拖拽排期功能
- 定时发布服务
- 日历事件管理

### Phase 3: 看板视图与流程管理
**目标**: 内容的流程维度管理
- 4列Kanban看板
- 拖拽改变状态
- 批量操作
- 流程可视化

### Phase 4: 可视化分析仪表板
**目标**: 数据的多维度分析
- 渠道统计图表
- 发布趋势分析
- 作者贡献排名
- 分类分布统计

## 📖 文档使用指南

### 对于项目经理
1. 阅读 [需求分析文档](requirements/01-需求分析文档.md) 了解完整需求
2. 查看 [实施计划](plannings/01-实施计划.md) 规划项目进度
3. 参考 [系统架构设计](design/01-系统架构设计.md) 了解技术方案

### 对于架构师
1. 研究 [系统架构设计](design/01-系统架构设计.md) 了解整体架构
2. 查看 [UML设计视图](uml/01-类图与时序图.md) 理解系统设计
3. 参考 [数据库详细设计](design/02-数据库详细设计.md) 了解数据模型

### 对于开发工程师
1. 阅读 [实施计划](plannings/01-实施计划.md) 了解开发任务
2. 查看 [数据库详细设计](design/02-数据库详细设计.md) 了解表结构
3. 参考 [UML设计视图](uml/01-类图与时序图.md) 了解业务流程
4. 按Phase顺序进行开发

### 对于测试工程师
1. 阅读 [需求分析文档](requirements/01-需求分析文档.md) 了解功能需求
2. 查看每个Phase的验证清单制定测试用例
3. 参考 [系统架构设计](design/01-系统架构设计.md) 了解系统边界

## 🔒 安全考虑

### 生产环境必须修改
- ⚠️ JWT_SECRET_KEY (默认: change-me-in-production)
- ⚠️ 默认管理员密码 (默认: admin123)
- ⚠️ 数据库连接字符串
- ⚠️ CORS允许域名

### 安全措施
- ✅ 密码使用bcrypt哈希
- ✅ JWT Token 7天过期
- ✅ 审计日志记录所有操作
- ✅ 社区级数据隔离
- ✅ XSS/CSRF防护
- ✅ SQL注入防护(ORM)

## 📝 文档维护

### 版本历史
- **v1.0** (2026-02-06) - 初始版本,包含完整的需求分析、系统设计、UML视图和实施计划

### 更新原则
1. 任何设计变更必须更新相关文档
2. 每个Phase完成后更新实施进度
3. 新增功能需补充相应的设计文档
4. 保持文档与代码同步

## 🤝 贡献指南

1. 文档采用Markdown格式
2. UML图表使用Mermaid语法(GitHub/GitLab兼容)
3. 代码示例使用对应语言的语法高亮
4. 保持文档结构清晰、层次分明
5. 中英文混排时注意空格规范

## 📧 联系方式

如有问题或建议,请联系项目团队。

---

**文档生成日期**: 2026-02-06
**文档版本**: v1.0
**项目状态**: 设计阶段完成,待进入Phase 1开发
